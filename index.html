<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tracking Plugin Test Page</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    .container {
      max-width: 600px;
      margin: auto;
    }
    button {
      padding: 10px 20px;
      margin: 5px 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Tracking Plugin Test Page</h1>
    
    <!-- Buttons for testing -->
    <button id="loginBtn">Simulate User Login</button>
    <button id="customActivityBtn">Track Custom Activity</button>    
    <button class="add_to_cart">Add to cart</button>
    <button class="wishlist">Wishlist</button>
  </div>

  <!-- Load the Tracking Plugin Asynchronously -->
  <script>
    (function() {
      var script = document.createElement("script");
      //script.src = "https://pushpa-mali-23.github.io/tracking-plugin/tracking-plugin.min.js";
      script.src = "tracking-plugin.min.js";
      script.async = true;
      script.onload = function() {
        console.log("Tracking Plugin Loaded");
        window.TrackingPlugin?.setWidgetId('hfSNfcb4BKvebGMTeK2p/A=='); // Replace with actual widget ID
      };
      document.head.appendChild(script);

      // Function to set user ID dynamically after login
      window.setTrackingUserId = function(userId) {
        if (window.TrackingPlugin && typeof window.TrackingPlugin.setUserId === 'function') {
          window.TrackingPlugin.setUserId(userId);
          console.log(`User ID set: ${userId}`);
        } else {
          console.error("TrackingPlugin.setUserId is not available yet.");
        }
      };
    })();
  </script>

  <!-- Test Scripts -->
  <script>
    // Simulate user login
    document.getElementById('loginBtn').addEventListener('click', () => {
      const userId = 5009; // Replace with actual user ID after authentication
      setTrackingUserId(userId); // Call the function to set the user ID
    });

    // Simulate product event tracking
    document.querySelector('.add_to_cart').addEventListener('click', () => {
      if (window.TrackingPlugin && typeof window.TrackingPlugin.trackProductEvent === 'function') {
        const eventName = 'add_to_cart';
        const productInfo = {
          id: 'dr-5979',
          name: 'Diamond Jewellery - 18 KT Gold',
          slug: 'dr-5979',
          sku: 'dr-5979'
        };
        
        window.TrackingPlugin.trackProductEvent(eventName, productInfo);
        console.log(`Product event tracked: ${eventName}`, productInfo);
        
      } else {
        console.error("TrackingPlugin.trackProductEvent is not available yet.");
      }
    });

    // Simulate custom activity tracking
    document.getElementById('customActivityBtn').addEventListener('click', () => {
      if (window.TrackingPlugin && typeof window.TrackingPlugin.trackCustomActivity === 'function') {
        const activityType = 'product_id';
        const typeId = 10; // Example product ID
        const additionalData = {
          activity_data: {
            product_name: 'Diamond Ring',
            price: 299.99
          }
        };
        window.TrackingPlugin.trackCustomActivity(activityType, typeId, additionalData);
        console.log(`Custom activity tracked: ${activityType}, Type ID: ${typeId}`);
      } else {
        console.error("TrackingPlugin.trackCustomActivity is not available yet.");
      }
    });
  </script>
</body>
</html>